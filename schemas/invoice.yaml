schema_name: "invoice"
schema_type: "invoice"
version: "v2"
description: "Schema for invoice document extraction with vendor info, line items, and totals"

fields:
  - name: "vendor_info"
    type: "text_dict"
    evaluation: "accuracy"
    weight: 0.20
    description: "Dictionary containing vendor name, address, and contact information"
    
  - name: "invoice_metadata"
    type: "text_dict"
    evaluation: "accuracy"
    weight: 0.15
    description: "Invoice number, date, due date, and PO number"
    
  - name: "line_items"
    type: "entity_list"
    evaluation: "f1"
    weight: 0.40
    description: "List of line items with description, quantity, unit price, and total"
    
  - name: "financial_totals"
    type: "numerical_dict"
    evaluation: "exact_match"
    weight: 0.25
    description: "Subtotal, tax, and total amounts"

prompt_template: |
  Analyze the invoice image and extract information into a JSON object.
  You must act as a precise data entry clerk. Focus on the actual text and numbers printed or handwritten on the document.

  REQUIRED JSON STRUCTURE:
  {
    "vendor_info": { "vendor_name": "...", "address": "...", "phone": "...", "email": "..." },
    "invoice_metadata": { "invoice_number": "...", "invoice_date": "...", "due_date": "...", "po_number": "..." },
    "line_items": [ { "description": "...", "quantity": 0, "unit_price": 0.0, "total": 0.0 }, ... ],
    "financial_totals": { "subtotal": 0.0, "tax": 0.0, "total": 0.0 }
  }

  EXTRACTION RULES:
  1. 'vendor_info': Extract vendor name, address, phone, and email. If a field is missing, use an empty string.
  2. 'invoice_metadata': Extract invoice number, date, due date, and PO number.
  3. 'line_items': Extract each line item with its details. Ensure quantity and prices are numbers.
  4. 'financial_totals': Extract subtotal, tax, and total. These must be numbers, not strings.
  5. Return ONLY the raw JSON object. No markdown code blocks, no explanations.

expected_structure:
  vendor_info:
    example: {"vendor_name": "ABC Corp", "address": "123 Main St", "phone": "555-1234"}
  invoice_metadata:
    example: {"invoice_number": "INV-001", "invoice_date": "2024-01-15", "due_date": "2024-02-15"}
  line_items:
    example: [{"description": "Widget A", "quantity": 10, "unit_price": 25.00, "total": 250.00}]
  financial_totals:
    example: {"subtotal": 250.00, "tax": 25.00, "total": 275.00}
